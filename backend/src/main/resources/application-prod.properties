# ========================================
# Photlas Backend - Production Configuration
# ========================================
# AWS本番環境用の設定ファイル
# すべての機密情報は環境変数から取得します

spring.application.name=photlas-backend

# ========================================
# Database Configuration (RDS PostgreSQL)
# ========================================
# RDSエンドポイント、パスワードは環境変数から取得
spring.datasource.url=jdbc:postgresql://${DB_HOST}:${DB_PORT:5432}/${DB_NAME:photlas}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# ========================================
# JPA/Hibernate Configuration
# ========================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
# 本番環境: DDLの自動生成は無効化（validate推奨）
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# ========================================
# HikariCP Configuration (Connection Pool)
# ========================================
# コネクションプールの最適化
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# ========================================
# H2 Console (本番環境では無効化)
# ========================================
spring.h2.console.enabled=false

# ========================================
# JWT Configuration
# ========================================
# JWT Secretは環境変数から必ず取得（デフォルト値なし）
jwt.secret=${JWT_SECRET}
jwt.expiration=86400000

# ========================================
# Mail Configuration (AWS SES)
# ========================================
# Amazon SES SMTP設定
spring.mail.host=email-smtp.ap-northeast-1.amazonaws.com
spring.mail.port=587
spring.mail.username=${SES_SMTP_USERNAME}
spring.mail.password=${SES_SMTP_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# メール送信元アドレス
photlas.mail.from=${MAIL_FROM:noreply@photlas.jp}

# ========================================
# AWS S3 Configuration
# ========================================
# S3バケット設定（環境変数から取得）
aws.s3.bucket-name=${AWS_S3_BUCKET_NAME}
aws.s3.region=${AWS_REGION:ap-northeast-1}
aws.s3.cloudfront-domain=${AWS_CLOUDFRONT_DOMAIN:}

# ========================================
# Server Configuration
# ========================================
server.port=8080
server.servlet.context-path=

# エラーページのカスタマイズ
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never
server.error.include-exception=false

# ========================================
# Actuator Configuration (Health Check)
# ========================================
# ALBのヘルスチェック用エンドポイント
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# ========================================
# Logging Configuration
# ========================================
# 本番環境: INFOレベル以上のログのみ
logging.level.root=INFO
logging.level.com.photlas.backend=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# ログファイルへの出力（オプション、CloudWatch Logsを使用する場合は不要）
# logging.file.name=/var/log/photlas/application.log
# logging.file.max-size=10MB
# logging.file.max-history=30

# ========================================
# Security Configuration
# ========================================
# CORS設定（本番環境用）
# photlas.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://photlas.com,https://www.photlas.com}

# ========================================
# Environment Information
# ========================================
# アプリケーション情報（Actuatorのinfoエンドポイントで表示）
info.app.name=Photlas Backend
info.app.description=Photo sharing platform for photographers
info.app.version=1.0.0
info.app.environment=production
